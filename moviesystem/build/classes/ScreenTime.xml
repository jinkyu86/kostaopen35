<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		
<mapper namespace="ScreenTime">		

<resultMap id="selectResultMap"
type="kr.or.kosta.moviesystem.screentime.ScreenTime">
	<result property="scrnum" column="scrnum"/>
    <result property="time" 	column="time"/>
    <result property="movie.mname" 	column="mname"/>
    <result property="movie.mnum" 		column="mnum"/>
</resultMap>


<select id="selectScreenTime"
				resultMap="selectResultMap">
		SELECT s.scr_num   as scrnum,
						s.time     as time,
						m.m_name   as mname,
						m.m_num         as mnum
		FROM MOVIE m  JOIN SCREENING_TIME s
		ON s.m_num=m.m_num
		WHERE s.scr_num=#{scrnum}
</select>

<select id="selectScreenList"
				resultMap="selectResultMap">
		SELECT s.scr_num   as scrnum,
						s.time     as time,
						m.m_name   as mname,
						m.m_num         as mnum
		FROM MOVIE m  JOIN SCREENING_TIME s
		ON s.m_num=m.m_num
		WHERE m.m_num=#{mnum} AND s.time>sysdate
</select>

<resultMap id="selectMap" type="kr.or.kosta.moviesystem.screentime.ScreenTime">
		<result property="scrnum" column="scr_num"/>
	</resultMap>


<select id="selectScreenTimeScrNum" resultMap="selectMap">
SELECT scr_num
		FROM SCREENING_TIME
		WHERE time=to_date(#{time},'yyyy-mm-dd hh24:mi:ss')
</select>


</mapper>


					
					