<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
	<mapper namespace="Block">

	<delete id="deleteBlock">
		     delete from tb_block where block_No=#{blockNo}	    
	</delete>
	
	<parameterMap type="kr.or.kosta.bookchange.member.Block"
	   id="insertParameterMap">
	 
		<parameter property="member.email"/>
		<parameter property="blockmember.email"/>
		<parameter property="blockContent"/>

	</parameterMap>

	
	<insert id="insertBlock" 
	     parameterMap="insertParameterMap">
    
	INSERT  INTO  tb_block
		(block_no,register_email,block_email,block_content,blockcondition_result)
	    VALUES (block_seq.nextval,?,?,?,0)
	</insert>

	<parameterMap
	   type="kr.or.kosta.bookchange.member.Block"
	   id="updateParameterMap">
	   	
		<parameter property="blockCondition.blockConditionResult"/>
	    <parameter property="blockNo"/>
	
	</parameterMap>
	
	<update id="updateBlock" 
	     parameterMap="updateParameterMap">
	     
		 update  tb_block
		 set blockCondition_result=?
		 where block_no=?	    
	
	</update>
		


    <resultMap id="selectResultMap" type="kr.or.kosta.bookchange.member.Block">
		<result property="blockNo" column="block_no"/>
		<result property="member.email" column="register_email"/>
		<result property="blockmember.email" column="block_email"/>
		<result property="blockContent" column="block_content"/>
		<result property="blockCondition.blockConditionResult" column="Result"/>
		<result property="blockCondition.blockConditionIng" column="Ing"/>
	</resultMap>
	<select id="selectBlockList" resultMap="selectResultMap">
		select 
		block_no as block_no,
		block_content as block_content,
		block_email as block_email,
		register_email as register_email,
		blockCondition_Ing as Ing
		from tb_block b,tb_blockCondition c
		where b.blockCondition_Result=c.blockCondition_Result
	</select>
		
		
	<select id="selectBlockCount" resultType="java.lang.Integer">
		select count(*) from tb_block
	</select>

	<select id="selectMyBlockList" resultMap="selectResultMap">
		select
		register_email as register_email,
		block_email as block_email,
		block_content as block_content,
		c.blockCondition_Ing as Ing,
		b.blockCondition_Result as Result
		from tb_block b,tb_blockcondition c
		where b.blockCondition_Result=c.blockCondition_Result
		and register_email=#{email}
	</select>
	
	<select id="selectBlockbyblockno" resultMap="selectResultMap">
		select 
		block_no as block_no,
		block_content as block_content,
		block_email as block_email,
		register_email as register_email,
		b.blockCondition_Result as Result,
		c.blockCondition_Ing as Ing
		from tb_block b,tb_blockcondition c
		where  b.blockCondition_Result=c.blockCondition_Result
		and block_no=#{blockNo} 
	</select>

	<select id="selectBlockbyResult" resultMap="selectResultMap">
		select 
		block_no as block_no,
		block_content as block_content,
		block_email as block_email,
		register_email as register_email,
		b.blockCondition_Result as Result,
		blockCondition_Ing as Ing
		from tb_block b,tb_blockcondition c
		where  b.blockCondition_Result=c.blockCondition_Result
		and b.blockCondition_Result=#{resultNo}
	</select>
	<select id="selectBlockbyResultCount" resultType="java.lang.Integer">
		select count(*)
	    from tb_block b,tb_blockcondition c
		where  b.blockCondition_Result=c.blockCondition_Result
		and b.blockCondition_Result=#{resultNo} 
	</select>
		<select id="selectBlockbyResulting" resultMap="selectResultMap">
		select 
		block_no as block_no,
		block_content as block_content,
		block_email as block_email,
		register_email as register_email,
		b.blockCondition_Result as Result,
		blockCondition_Ing as Ing
		from tb_block b,tb_blockcondition c
		where b.blockCondition_Result=c.blockCondition_Result
		and b.blockCondition_Result=#{resulting} 
	</select>
     <select id="selectBlockResultCounting" resultType="java.lang.Integer">
		select count(*) from tb_blockcondition b,tb_block c 
		where b.blockCondition_Result=c.blockCondition_Result
		and c.blockCondition_Result=#{resultno}
	</select>

</mapper>